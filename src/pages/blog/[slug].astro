---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const blogPosts = await getCollection('blog');
  return blogPosts.map((post) => ({
    params: { slug: post.data.id || post.slug },
    props: post,
  }));
}

const post = Astro.props as any;
const { Content } = await post.render();
---

<Layout title={`${post.data.title} - Paper After Word`} currentPage="blog">
  <div class="back">
    <a href="/">← 一覧に戻る</a>
  </div>

  <main class="contents">
    <article class="content -edit">
      <div class="content_inner">
        <header class="content_header">
          <h1 class="content_header_title">{post.data.title}</h1>
          <ul class="content_header_summary">
            <li>{post.data.author}</li>
            <li>{new Date(post.data.date).toLocaleDateString('ja-JP')}</li>
          </ul>
        </header>
        
        <p><strong>{post.data.description}</strong></p>

        <div class="images">
          <div class="book-cover">
            <img src={post.data.coverImage || "/images/default/no-cover.svg"} alt="本の表紙" />
          </div>
          {post.data.origamiImage && (
            <div class="origami-work">
              <img src={post.data.origamiImage} alt="折り紙作品" />
            </div>
          )}
        </div>

        <Content />
      </div>
    </article>
  </main>
</Layout>